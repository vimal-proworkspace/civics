<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Civic Portal — Municipality Dashboard</title>
  <style>
    body{font-family:Arial, sans-serif;background:#f4f7fb;margin:0;color:#222;}
    header{background:#2b6cb0;color:#fff;padding:16px;}
    .container{max-width:900px;margin:20px auto;padding:0 16px;}
    .card{background:#fff;padding:16px;margin-bottom:18px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.08);}
    .complaint{border-left:4px solid #ddd;padding:12px;margin-bottom:12px;background:#fafafa;border-radius:6px;}
    .status{font-size:12px;background:#edf2ff;color:#2b6cb0;padding:3px 8px;border-radius:10px;margin-left:8px;}
    img{max-width:120px;border-radius:6px;margin-top:6px;}
    .controls{margin-top:8px;display:flex;gap:8px;}
  </style>
</head>
<body>
<header><h2>Municipality Officer Dashboard</h2></header>
<div class="container">
  <div class="card">
    <h3>All Complaints</h3>
    <div id="officerList"></div>
  </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyBA39nLboEO6tvkqwG7Z5rPjioDZGrvv24",
    authDomain: "civics-f8073.firebaseapp.com",
    projectId: "civics-f8073",
    storageBucket: "civics-f8073.firebasestorage.app",
    messagingSenderId: "883472536043",
    appId: "1:883472536043:web:16ed5d8ebbee58599489ae",
    measurementId: "G-6LREGGS57C"
  };
  firebase.initializeApp(firebaseConfig);
  const db=firebase.firestore();

  const officerList=document.getElementById("officerList");

  // Load complaints in real-time
  db.collection("complaints").orderBy("createdAt","desc").onSnapshot(snap=>{
    officerList.innerHTML="";
    snap.forEach(doc=>{
      const d=doc.data();
      let div=document.createElement("div");
      div.className="complaint";
      div.innerHTML=`<strong>${d.category} — ${d.location}</strong>
                     <span class="status">${d.status}</span>
                     <p>${d.description}</p>`;
      if(d.photoURL){div.innerHTML+=<img src="${d.photoURL}"/>;}

      // controls
      let sel=document.createElement("select");
      ["new","in-progress","resolved"].forEach(s=>{
        let o=document.createElement("option");o.value=s;o.textContent=s;if(s===d.status)o.selected=true;sel.appendChild(o);
      });
      let btn=document.createElement("button");btn.textContent="Update";
      btn.onclick=()=>db.collection("complaints").doc(d.id).update({status:sel.value});

      let ctrl=document.createElement("div");ctrl.className="controls";ctrl.appendChild(sel);ctrl.appendChild(btn);
      div.appendChild(ctrl);

      officerList.appendChild(div);
    });
  });
</script>
</body>
</html>